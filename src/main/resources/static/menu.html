<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Restaurant A Menu</title>
</head>
<body>
    <h1>Menu - Restaurant A</h1>

    <form id="order-form">
        <ul id="menu-list"></ul>
        <button type="submit">Calculate Total</button>
    </form>

    <h2 id="total-price"></h2>

    <script>
        fetch("/menu")
            .then(res => res.json())
            .then(data => {
                const ul = document.getElementById("menu-list");
                data.forEach(item => {
                    const li = document.createElement("li");
                    li.innerHTML = `<label><input type="checkbox" value="${item.name}"> ${item.name} (${item.price} THB)</label>`;
                    ul.appendChild(li);
                });
            });

        document.getElementById("order-form").addEventListener("submit", function(e) {
            e.preventDefault();
            const selected = Array.from(document.querySelectorAll("input[type='checkbox']:checked"))
                                  .map(cb => cb.value);

            fetch("/calculate-price", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ dishes: selected })
            })
            .then(res => res.json())
            .then(data => {
                document.getElementById("total-price").innerText = "Total Price: " + data.totalPrice + " THB";
            });
        });
    </script>
</body>
</html>
